"""
Configuration settings for FinTech Forecasting Application
"""

import os
from dotenv import load_dotenv
from pathlib import Path

# Load environment variables
load_dotenv()

# Base directories
BASE_DIR = Path(__file__).resolve().parent.parent
DATA_DIR = BASE_DIR / 'data'
RAW_DATA_DIR = DATA_DIR / 'raw'
PROCESSED_DATA_DIR = DATA_DIR / 'processed'
PREDICTIONS_DIR = DATA_DIR / 'predictions'
MODEL_SAVE_PATH = BASE_DIR / 'models' / 'saved'
LOG_DIR = BASE_DIR / 'logs'

# Create directories if they don't exist
for directory in [DATA_DIR, RAW_DATA_DIR, PROCESSED_DATA_DIR, 
                  PREDICTIONS_DIR, MODEL_SAVE_PATH, LOG_DIR]:
    directory.mkdir(parents=True, exist_ok=True)

# Database Configuration
DB_TYPE = os.getenv('DB_TYPE', 'sqlite')
DB_PATH = os.getenv('DB_PATH', str(DATA_DIR / 'fintech.db'))
MONGODB_URI = os.getenv('MONGODB_URI', 'mongodb://localhost:27017/')
MONGODB_DB_NAME = os.getenv('MONGODB_DB_NAME', 'fintech_forecasting')

# API Configuration
REQUEST_DELAY = int(os.getenv('REQUEST_DELAY', 2))
MAX_RETRIES = int(os.getenv('MAX_RETRIES', 3))

# Supported Exchanges
SUPPORTED_EXCHANGES = {
    'NASDAQ': 'NASDAQ Stock Market',
    'NYSE': 'New York Stock Exchange',
    'LSE': 'London Stock Exchange',
    'TSE': 'Tokyo Stock Exchange',
    'CRYPTO': 'Cryptocurrency'
}

# Headers for web scraping
HEADERS = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
    'Accept-Language': 'en-US,en;q=0.5',
    'Accept-Encoding': 'gzip, deflate',
    'DNT': '1',
    'Connection': 'keep-alive',
    'Upgrade-Insecure-Requests': '1'
}

# Technical Indicators Configuration
TECHNICAL_INDICATORS = {
    'sma_periods': [5, 10, 20, 50, 200],
    'ema_periods': [12, 26],
    'rsi_period': 14,
    'bollinger_period': 20,
    'bollinger_std': 2,
    'macd_fast': 12,
    'macd_slow': 26,
    'macd_signal': 9
}

# News Sources
NEWS_SOURCES = {
    'yahoo_finance': {
        'base_url': 'https://finance.yahoo.com',
        'enabled': True
    },
    'reuters': {
        'rss_url': 'https://www.reutersagency.com/feed/?taxonomy=best-topics&post_type=best',
        'enabled': True
    },
    'coindesk': {
        'rss_url': 'https://www.coindesk.com/arc/outboundfeeds/rss/',
        'enabled': True
    }
}

# Model Configuration
MODEL_CONFIG = {
    'traditional': {
        'arima': {
            'enabled': True,
            'order': (5, 1, 0),
            'seasonal_order': (1, 1, 1, 12)
        },
        'var': {
            'enabled': True,
            'maxlags': 15
        },
        'moving_average': {
            'enabled': True,
            'windows': [5, 10, 20]
        }
    },
    'neural': {
        'lstm': {
            'enabled': True,
            'units': [64, 32],
            'dropout': 0.2,
            'epochs': 100,
            'batch_size': 32
        },
        'gru': {
            'enabled': True,
            'units': [64, 32],
            'dropout': 0.2,
            'epochs': 100,
            'batch_size': 32
        },
        'transformer': {
            'enabled': True,
            'num_heads': 4,
            'hidden_dim': 128,
            'epochs': 100,
            'batch_size': 32
        }
    }
}

# Prediction Horizons (in hours)
PREDICTION_HORIZONS = [1, 3, 24, 72]

# Logging Configuration
LOG_LEVEL = os.getenv('LOG_LEVEL', 'INFO')
LOG_FILE = os.getenv('LOG_FILE', str(LOG_DIR / 'app.log'))
LOG_FORMAT = '%(asctime)s - %(name)s - %(levelname)s - %(message)s'

# Application Settings
APP_PORT = int(os.getenv('APP_PORT', 8501))
APP_TITLE = "FinTech Forecasting Dashboard"
APP_ICON = "ðŸ“ˆ"

# Feature Engineering
FEATURE_SETS = {
    'minimal': [
        'Open', 'High', 'Low', 'Close', 'Volume',
        'SMA_20', 'EMA_12', 'RSI', 'MACD'
    ],
    'standard': [
        'Open', 'High', 'Low', 'Close', 'Volume',
        'SMA_5', 'SMA_10', 'SMA_20', 'SMA_50',
        'EMA_12', 'EMA_26', 'RSI', 'MACD', 'MACD_Signal',
        'BB_Upper', 'BB_Lower', 'Volatility_20d'
    ],
    'full': None  # Use all available features
}

# Model Evaluation Metrics
EVALUATION_METRICS = ['RMSE', 'MAE', 'MAPE', 'R2']

# Training/Testing Split
TRAIN_TEST_SPLIT = 0.8
VALIDATION_SPLIT = 0.1

# Sequence length for time series models
SEQUENCE_LENGTH = 60  # Use 60 time steps for prediction